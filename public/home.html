<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>飛騰家電 - 首頁</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="navbar">
    <div class="nav-left">
      <img src="logo1.png" alt="飛騰家電logo" class="logo" />
      <span class="username"></span>
    </div>
  </div>

  <div class="page-title">會員功能首頁</div>

  <div class="menu-card-container">
      <a href="query.html" class="big-card query">報修查詢</a>
      <a href="repair.html" class="big-card repair">報修</a>
      <a href="history.html" class="big-card repair">購買歷史</a>
      <a href="info.html" class="big-card repair">會員資料</a>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
    const accountName = localStorage.getItem("userName");
  
    if (!accountName) {
      document.querySelector('.username').textContent = "歡迎，訪客";
      return;
    }
  
    fetch('/api/proxy-query', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ Account_Name: accountName })
    })
      .then(res => res.json())
      .then(data => {
        if (data.Result === 0 && data.Name) {
          document.querySelector('.username').textContent = `歡迎，${data.Name}`;
        } else {
          document.querySelector('.username').textContent = "歡迎，會員";
        }
      })
      .catch(err => {
        console.error("查詢會員錯誤：", err);
        document.querySelector('.username').textContent = "歡迎，會員";
      });
    });
  </script>
</body>
</html>
